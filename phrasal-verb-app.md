## 專案概述

### 動機與目標
起初，我希望學習英文片語動詞（Phrasal Verbs），但發現單純依賴記憶並非有效的方法。因此，我構思了一種以故事為基礎的學習方式，並決定藉此機會開發一個應用程式，同時學習前後端分離的全端應用程式開發技術。

### 專案演進
這個專案從一個簡單的概念開始，逐步發展成一個功能完整的全端應用程式。以下是專案的兩個主要版本：

#### 第一版
在應用程式的初版中，由於故事內容是透過 AI 自動生成，而 API 金鑰只能儲存在前端，且後端未建立資料庫，因此每次用戶啟動新的 session 時，必須重新填寫 API 金鑰，導致使用體驗不佳。

#### 第二版
第二版應用程式引入了 Google OAuth 身份驗證以及 SQLite 資料庫。用戶可以通過 Google 帳號登入，並將 API 金鑰安全地儲存至與帳號對應的資料庫中。應用程式前端提供了直觀的使用介面，讓用戶能夠生成包含片語動詞的故事。如果對生成的故事不滿意，用戶可以請求重新生成；滿意的故事則可儲存至「我的最愛故事」中，並同步記錄到資料庫。即使用戶關閉瀏覽器，下次登入時，都還是能檢視已儲存的內容，提升使用便利性與體驗。

這個第二版應用程式是我第一個相對完整的全端網頁應用程式，從需求分析到實現，涵蓋了前端、後端及資料庫整合的全過程。

## 技術挑戰與解決方案

### 後端挑戰
1. **安全性與身份驗證**
    - **問題：** 如何安全地管理用戶身份和 API 金鑰？
    - **解決方案：** 實作了 Google OAuth 2.0 身份驗證系統，並使用 JWT (JSON Web Tokens) 進行用戶會話管理。同時使用 Fernet 對稱加密來安全地存儲用戶的 API 金鑰。

2. **資料持久化與管理**
    - **問題：** 如何在用戶會話之間保持數據？
    - **解決方案：** 採用 SQLAlchemy ORM 搭配 SQLite 資料庫，建立了有效的資料模型來儲存用戶資料、API 金鑰和最愛故事。這讓用戶可以在不同的會話中保持其數據。

3. **API 整合與故事生成**
    - **問題：** 如何有效地利用 OpenAI API 生成故事？
    - **解決方案：** 使用 LangChain 框架整合 OpenAI API，並設計了特定的 prompt template 來生成包含片語動詞的故事。通過精心設計的提示模板，確保生成的內容既有教育意義又具有趣味性。

4. **跨域資源共享（CORS）**
    - **問題：** 如何確保前後端分離架構下的 API 安全？
    - **解決方案：** 在 FastAPI 後端實作了 CORS 中間件，僅允許特定的前端 URL 訪問 API，確保了應用程式的安全性同時也支援前後端分離架構。

5. **環境配置與部署**
    - **問題：** 如何在不同環境中靈活部署應用程式？
    - **解決方案：** 使用 Docker 容器化應用程式，並實作了環境變數管理（使用 .env 檔案），使得開發、測試和生產環境的配置和部署更加靈活和安全。同時通過 requirements.txt 確保了依賴套件的版本控制。

### 前端挑戰
1. **使用者身份驗證與狀態管理**
    - **問題：** 如何管理用戶登入狀態和應用程式狀態？
    - **解決方案：** 使用 streamlit_cookies_controller 管理用戶登入狀態，實作了 Google OAuth 登入流程，並透過 session state 維護應用程式的狀態，確保用戶在不同頁面間的資料一致性。

2. **動態內容更新與互動性**
    - **問題：** 如何實現動態生成內容和用戶互動？
    - **解決方案：** 利用 Streamlit 的狀態管理機制，實現了片語動詞的動態生成、故事生成和收藏功能。透過自定義的 SessionState 類別，確保用戶操作（如生成新故事、儲存收藏）能即時反映在介面上。

3. **視覺化與樣式客製化**
    - **問題：** 如何客製化應用程式的視覺外觀？
    - **解決方案：** 建立了統一的樣式系統（Styles 類別），使用 HTML/CSS 自定義元件外觀，並實作了片語動詞高亮顯示功能。同時通過 config.toml 配置，客製化了 Streamlit 的主題顏色。

4. **前後端整合與 API 管理**
    - **問題：** 如何有效地管理前後端 API 請求？
    - **解決方案：** 封裝了 APIHandler 類別統一管理所有 API 請求，實現了錯誤處理機制，並使用環境變數（.env）管理後端 URL，使開發和部署環境能靈活切換。

5. **多頁面應用程式架構**
    - **問題：** 如何組織多頁面應用程式？
    - **解決方案：** 採用 Streamlit 的多頁面功能，將應用程式分為首頁、故事生成器、收藏故事和設定頁面，並確保各頁面間的狀態同步和資料共享。每個頁面都保持一致的設計風格和使用者體驗。


